<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì¹´í˜ ì£¼ë¬¸</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        /* ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        .table-indicator {
            display: inline-block;
            background-color: #FFF8E7;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            color: #333;
            margin-left: 10px;
        }

        .header-title {
            display: flex;
            align-items: center;
            padding: 10px 20px;
        }

        .store-name {
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
  </head>
  <body>
    <header class="store-header">
      <div class="header-title">
        <span class="store-name">ê³µê³µ</span>
        <span class="table-indicator" style="display: none;">í…Œì´ë¸” <span id="tableNumber"></span>ë²ˆ</span>
      </div>
      <button class="menu-button">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M3 12h18M3 6h18M3 18h18" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <!-- ë“œë¡­ë‹¤ìš´ ë©”ë‰´ -->
      <div class="dropdown-menu">
        <div class="menu-list">
            <button id="orderHistoryBtn">
                <i class="fas fa-history"></i>
                ì£¼ë¬¸ë‚´ì—­
            </button>
            <div class="divider"></div>
            <button id="loginBtn">
                <i class="fas fa-user"></i>
                ë¡œê·¸ì¸
            </button>
            <div class="divider"></div>
            <a href="#" class="sns-link" target="_blank">
                <i class="fab fa-instagram"></i>
                Instagram
            </a>
        </div>
      </div>
    </header>

    <nav class="category-nav">
      <ul>
        <li><a href="#all" th:text="ì „ì²´">ì „ì²´</a></li>
        <li th:each="category : ${categories}">
            <a th:href="'#' + ${category}" th:text="${category}"></a>
        </li>
      </ul>
    </nav>

    <main>
      <div class="promotion-banner" th:if="${restaurant != null}">
        <span class="promotion-icon">ğŸ“¢</span>
        <span th:text="${restaurant.description}"></span>
      </div>

      <section id="menu-list">
        <!-- ë©”ë‰´ í•­ëª©ì´ JavaScriptë¡œ ë™ì  ì¶”ê°€ë¨ -->
      </section>
    </main>

    <footer class="cart-footer">
      <button id="view-cart" class="cart-button">
        ì¥ë°”êµ¬ë‹ˆ ë³´ê¸°
        <span class="cart-count">0</span>
      </button>
    </footer>
    <script th:inline="javascript">
      // ì„œë²„ì—ì„œ ë°›ì€ ë©”ë‰´ ë°ì´í„°
      const menuData = {
        menus: /*[[${menus}]]*/ [],
        categories: /*[[${categories}]]*/ []
      };
      
      // localStorageì— ë©”ë‰´ ë°ì´í„° ì €ì¥
      localStorage.setItem('menuData', JSON.stringify(menuData));

      // URLì—ì„œ í…Œì´ë¸” ë²ˆí˜¸ì™€ ì‹ë‹¹ ID ê°€ì ¸ì˜¤ê¸°
      function getTableNumber() {
        const urlParams = new URLSearchParams(window.location.search);
        const tableId = urlParams.get('tableId') || '1';
        const restaurantId = urlParams.get('restaurantId');
        
        // í…Œì´ë¸” ë²ˆí˜¸ í‘œì‹œ
        document.getElementById('tableNumber').textContent = tableId;
        document.querySelector('.table-indicator').style.display = 'inline-block';

        // ë©”ë‰´ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (í˜„ì¬ /menuê°€ ì•„ë‹Œ ê²½ìš°)
        if (!window.location.pathname.includes('/menu') && restaurantId) {
          window.location.href = `/menu?restaurantId=${restaurantId}&tableId=${tableId}`;
        }
      }
      getTableNumber();
    </script>
    <script type="module" th:src="@{/js/cart-service.js}"></script>
    <script type="module" th:src="@{/js/script.js}"></script>

  </body>
</html>
